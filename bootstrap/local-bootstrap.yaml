# Run as local user you want to be able to remotely provision, needs sudo access

- name: Local Server Bootstrap
  hosts: localhost
  connection: local
  tasks:
  - name: Ensure Boot Strap Packages are present
    ansible.builtin.dnf:
      update_cache: yes
      name:
        - sshpass
        - openssh-server
      allowerasing: yes
      state: present
  - name: Ensure ssh directory exist
    ansible.builtin.file:
      path: "{{ ansible_user_dir }}/.ssh"
      state: directory
      mode: '0700'
      owner: "{{ localhost_user }}"
      group: "{{ localhost_user_group }}"
  - name: Ensure user account has ssh key pair generated
    community.crypto.openssh_keypair:
      path: "{{ ansible_user_dir }}/.ssh/id_rsa"
      owner: "{{ localhost_user }}"
      group: "{{ localhost_user_group }}"
  - name: Ensure sshd is enable and started
    ansible.builtin.systemd:
      name: sshd
      enabled: yes
      state: started